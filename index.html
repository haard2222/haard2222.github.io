<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeSaver - Blood Donation Network</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="header__title">ü©∏ LifeSaver</h1>
                <nav class="header__nav">
                    <select id="languageSelector" class="btn btn--outline btn--sm" aria-label="Select Language">
  <option value="en" selected>English</option>
  <option value="hi">Hindi</option>
  <option value="bn">Bengali</option>
  <option value="ta">Tamil</option>
  <option value="te">Telugu</option>
  <option value="mr">Marathi</option>
  <option value="gu">Gujarati</option>
  <option value="kn">Kannada</option>
  <option value="ml">Malayalam</option>
  <option value="pa">Punjabi</option>
</select>

                    <button class="btn btn--secondary btn--sm" id="homeBtn">Home</button>
                    <button class="btn btn--primary btn--sm" id="requestBloodBtn">Request Blood</button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Homepage Section -->
    <section class="homepage" id="homePage">
        <div class="container">
            <!-- Hero Section -->
            <div class="hero">
                <h2 class="hero__title">Save Lives Through Blood Donation</h2>
                <p class="hero__description">Connect with verified blood donors in your area instantly. Upload your medical documents and find compatible donors nearby.</p>
                <div class="hero__actions">
                    <button class="btn btn--primary btn--lg" id="startRequestBtn">Request Blood Now</button>
                    <button class="btn btn--outline btn--lg" id="becomeDonorBtn">Become a Donor</button>
                </div>
            </div>

            <!-- Statistics Section -->
            <div class="stats-section">
                <h3 class="stats-section__title">Live Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card__value" id="totalDonors">15</div>
                        <div class="stat-card__label">Available Donors</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card__value" id="livesSaved">42</div>
                        <div class="stat-card__label">Lives Saved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card__value" id="activeRequests">8</div>
                        <div class="stat-card__label">Active Requests</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card__value">24/7</div>
                        <div class="stat-card__label">Service Available</div>
                    </div>
                </div>
            </div>

            <!-- Top Donor Showcase -->
            <div class="top-donor-section">
                <h3 class="section-title">üèÜ Top Donor of the Month</h3>
                <div class="top-donor-card">
                    <div class="donor-avatar" id="topDonorAvatar">VS</div>
                    <div class="donor-info">
                        <h4 class="donor-name" id="topDonorName">Vikram Singh</h4>
                        <div class="donor-details">
                            <span class="blood-type-badge" id="topDonorBloodType">O-</span>
                            <span class="donation-count" id="topDonorCount">31 donations</span>
                        </div>
                        <p class="donor-location" id="topDonorLocation">Karol Bagh, New Delhi</p>
                        <p class="donor-message">"Donating blood is the most beautiful way to say 'I care about you' to humanity."</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Document Upload Section -->
    <section class="upload-section hidden" id="uploadSection">
        <div class="container">
            <div class="card upload-card">
                <div class="card__header">
                    <h3>Upload Medical Documents</h3>
                    <p class="upload-card__subtitle">Upload prescription or hospital requisition to verify your blood requirement</p>
                </div>
                <div class="card__body">
                    <div class="upload-zone" id="uploadZone">
                        <div class="upload-zone__content">
                            <div class="upload-zone__icon">üìÑ</div>
                            <p class="upload-zone__text">
                                <span class="upload-zone__primary">Click to upload</span> or drag and drop
                            </p>
                            <p class="upload-zone__secondary">JPG, PNG or PDF (max. 5MB)</p>
                        </div>
                        <input type="file" id="fileInput" class="upload-zone__input" accept=".jpg,.jpeg,.png,.pdf" />
                    </div>
                    
                    <!-- Processing State -->
                    <div class="processing-state hidden" id="processingState">
                        <div class="processing-state__spinner"></div>
                        <p class="processing-state__text">Analyzing document with AI...</p>
                        <div class="processing-state__progress">
                            <div class="processing-state__progress-bar" id="progressBar"></div>
                        </div>
                    </div>

                    <!-- Verification Results -->
                    <div class="verification-results hidden" id="verificationResults">
                        <div class="verification-results__header">
                            <div class="verification-results__icon" id="resultIcon">‚úÖ</div>
                            <h4 class="verification-results__title" id="resultTitle">Document Verified</h4>
                        </div>
                        <p class="verification-results__details" id="resultDetails"></p>
                        <div class="verification-results__confidence">
                            <span>Confidence Score: <strong id="confidenceScore">95%</strong></span>
                        </div>
                        <button class="btn btn--primary" id="proceedToListBtn">View Available Donors</button>
                    </div>

                    <!-- Demo Notice -->
                    <div class="demo-notice">
                        <p><strong>Demo Mode:</strong> This is a simulation for demonstration purposes. In production, documents would be processed securely on the server.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Blood Type Selection -->
    <section class="blood-type-section hidden" id="bloodTypeSection">
        <div class="container">
            <div class="card">
                <div class="card__header">
                    <h3>Select Blood Type Needed</h3>
                    <p>Choose the blood type you need to find compatible donors</p>
                </div>
                <div class="card__body">
                    <div class="blood-type-grid">
                        <button class="blood-type-btn" data-blood-type="A+">A+</button>
                        <button class="blood-type-btn" data-blood-type="A-">A-</button>
                        <button class="blood-type-btn" data-blood-type="B+">B+</button>
                        <button class="blood-type-btn" data-blood-type="B-">B-</button>
                        <button class="blood-type-btn" data-blood-type="AB+">AB+</button>
                        <button class="blood-type-btn" data-blood-type="AB-">AB-</button>
                        <button class="blood-type-btn" data-blood-type="O+">O+</button>
                        <button class="blood-type-btn" data-blood-type="O-">O-</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Donor List Section -->
    <section class="donor-list-section hidden" id="donorListSection">
        <div class="container">
            <div class="donor-list-header">
                <h3>Available Donors <span class="donor-count" id="donorCount">(15)</span></h3>
                <div class="list-controls">
                    <div class="search-box">
                        <input type="text" class="form-control" id="searchInput" placeholder="Search by name or area...">
                    </div>
                    <div class="filter-controls">
                        <select class="form-control form-control--inline" id="sortFilter">
                            <option value="distance">Sort by Distance</option>
                            <option value="donations">Sort by Donations</option>
                            <option value="recent">Sort by Recent Activity</option>
                            <option value="bloodType">Sort by Blood Type</option>
                        </select>
                        <select class="form-control form-control--inline" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="available">Available</option>
                            <option value="busy">Busy</option>
                            <option value="away">Away</option>
                            <option value="emergency-only">Emergency Only</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="donor-list" id="donorList">
                <!-- Donor cards will be populated dynamically -->
            </div>

            <div class="pagination" id="pagination">
                <button class="btn btn--outline" id="loadMoreBtn">Load More Donors</button>
            </div>
        </div>
    </section>

    <!-- Donor Registration Form -->
    <section class="registration-section hidden" id="registrationSection">
        <div class="container">
            <div class="card registration-card">
                <div class="card__header">
                    <h3>Become a Blood Donor</h3>
                    <p>Join our community of life savers and help those in need</p>
                </div>
                <div class="card__body">
                    <form class="registration-form" id="registrationForm">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="donorName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="donorPhone" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Blood Type</label>
                            <select class="form-control" id="donorBloodType" required>
                                <option value="">Select Blood Type</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Area</label>
                            <select class="form-control" id="donorArea" required>
                                <option value="">Select Area</option>
                                <option value="Connaught Place">Connaught Place</option>
                                <option value="India Gate">India Gate</option>
                                <option value="Red Fort Area">Red Fort Area</option>
                                <option value="Lodhi Road">Lodhi Road</option>
                                <option value="Karol Bagh">Karol Bagh</option>
                                <option value="Lajpat Nagar">Lajpat Nagar</option>
                                <option value="Nehru Place">Nehru Place</option>
                                <option value="Saket">Saket</option>
                                <option value="Vasant Kunj">Vasant Kunj</option>
                                <option value="Dwarka">Dwarka</option>
                                <option value="Rohini">Rohini</option>
                                <option value="Pitampura">Pitampura</option>
                                <option value="Civil Lines">Civil Lines</option>
                                <option value="Chandni Chowk">Chandni Chowk</option>
                                <option value="Janakpuri">Janakpuri</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Preferred Time</label>
                            <select class="form-control" id="donorPreferredTime" required>
                                <option value="">Select Time</option>
                                <option value="Morning">Morning</option>
                                <option value="Afternoon">Afternoon</option>
                                <option value="Evening">Evening</option>
                                <option value="Anytime">Anytime</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn--primary btn--full-width">Register as Donor</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Quote Banner -->
    <div class="quote-banner" id="quoteBanner">
        <div class="quote-content">
            <p class="quote-text" id="quoteText">Give blood, give life - your donation can save up to 3 lives</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="app.js"></script>
    <script>const API_URL = 'https://translate.openlibre.com/translate'; // OpenLibre public instance

// Utility: get all visible text nodes inside an element
function getVisibleTextNodes(element) {
  const walker = document.createTreeWalker(
    element,
    NodeFilter.SHOW_TEXT,
    {
      acceptNode: function(node) {
        // Filter out empty or whitespace-only nodes
        if (!node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
        // Check if parent is visible
        const style = window.getComputedStyle(node.parentNode);
        if (style.display === 'none' || style.visibility === 'hidden') return NodeFilter.FILTER_REJECT;
        return NodeFilter.FILTER_ACCEPT;
      }
    },
    false
  );
  
  let node;
  const nodes = [];
  while(node = walker.nextNode()) {
    nodes.push(node);
  }
  return nodes;
}

// Translate an array of strings in bulk using OpenLibre Translate API
async function translateBatch(textArray, targetLang) {
  try {
    const response = await fetch(API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        q: textArray,
        source: 'en',
        target: targetLang,
        format: 'text'
      })
    });
    const data = await response.json();
    return data.translatedText || [];
  } catch (err) {
    console.error('Translation API error:', err);
    return textArray; // fallback to original
  }
}

// Main translation function
async function translatePage(targetLang) {
  if (targetLang === 'en') {
    // Reload page or reset text if needed
    location.reload();
    return;
  }

  const textNodes = getVisibleTextNodes(document.body);
  const originalTexts = textNodes.map(node => node.nodeValue.trim());

  // Split into batches to avoid too long requests (max 10 texts per batch)
  const batchSize = 10;
  for (let i = 0; i < originalTexts.length; i += batchSize) {
    const batchTexts = originalTexts.slice(i, i + batchSize);
    const translatedBatch = await translateBatch(batchTexts, targetLang);

    // Replace text nodes with translated text
    for (let j = 0; j < translatedBatch.length; j++) {
      // Sometimes the translatedBatch can be a single string if one input is given, so check type
      const translatedText = Array.isArray(translatedBatch) ? translatedBatch[j] : translatedBatch;
      textNodes[i + j].nodeValue = translatedText;
    }
  }
}

// Example: listen to language selector dropdown changes
document.getElementById('languageSelector')?.addEventListener('change', (e) => {
  const lang = e.target.value;
  translatePage(lang);
});

// Optional: auto-translate to Hindi on page load for demo
// document.addEventListener('DOMContentLoaded', () => translatePage('hi'));
</script>
</body>
</html>
